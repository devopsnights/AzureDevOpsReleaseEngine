parameters:
  - name: resourceType
    type: object



steps:
  - powershell: |
      Write-Host "RE repo: $(releaseEngineRepositoryName)"
      Get-ChildItem -Path $(Build.SourcesDirectory)

  - powershell: |
      Write-Host "##[section]Building bicep file: $env:bicepFilePath"
      $file = $env:bicepFilePath
      New-Item -ItemType Directory -Force -Path $(build.artifactstagingdirectory)/infrastructure
      az bicep build --file $file --outdir $(build.artifactstagingdirectory)/infrastructure

      Get-ChildItem $(build.artifactstagingdirectory)/infrastructure
    displayName: 'Build bicep artifact' 
    env:
      bicepFilePath: $(releaseEngineRepositoryName)/src/cloud/azure/${{ parameters.resourceType }}/${{ parameters.resourceType }}.bicep

      