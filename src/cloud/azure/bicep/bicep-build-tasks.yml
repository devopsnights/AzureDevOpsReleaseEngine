parameters:
  - name: azureServiceConnection
    type: string
  - name: bicepFilePath
    type: string

steps:
  
  - powershell: |
      $file = $env:bicepFilePath
      New-Item -ItemType Directory -Force -Path $(build.artifactstagingdirectory)/infrastructure
      az bicep build --file $file --outdir $(build.artifactstagingdirectory)/infrastructure      
    displayName: 'Build bicep artifact' 
    env:
      bicepFilePath: ${{ parameters.bicepFilePath }}