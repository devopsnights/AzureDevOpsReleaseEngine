parameters:
  - name: settings
    type: object
  - name: resources
    type: object

variables:
  - name: azureServiceConnection
    value: ServiceConnection

stages:

  - ${{ if eq(parameters.settings.build.enabled, 'true') }}:
    - stage: build
      
      jobs:
        
        - template: ./_jobs/build-jobs.yml
          parameters:
            settings: ${{ parameters.settings }}
            resources: ${{ parameters.resources }}

  - ${{ if eq(parameters.settings.deploy.enabled, 'true') }}:
    - ${{ each env in parameters.settings.environments }}:
      - stage: ${{ env }}
      
        variables:
          - template: ./cloud/azure/resourceGroup/examples/variables/dev-vars.yml

        jobs:
          - job: BuildJob
            displayName: Build Job
            steps:
              - powershell: |
                  Write-Host ${{ parameters.settings.randomVariable }}